<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="John Powers" />

<meta name="date" content="2021-10-27" />

<title>Schiedea hookeri/kaalae RIMs</title>

<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="libs/navigation-1.1/tabsets.js"></script>
<script src="libs/navigation-1.1/codefolding.js"></script>
<link href="libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Schiedea hookeri/kaalae RIMs</h1>
<h4 class="author"><a href="http://sites.uci.edu/powers/">John Powers</a></h4>
<h4 class="date">2021-10-27</h4>

</div>


<style type="text/css">
  .main-container { max-width: 1000px; margin-left: 0; margin-right: auto; }
img{ max-width:200%; height: auto; }
td, th { padding : 6px }
</style>
<pre class="r"><code>library(tidyverse)
library(RColorBrewer)

library(glmmTMB)
library(car)
library(broom)
library(emmeans)

library(knitr)
knitr::opts_chunk$set(comment=&quot;&quot;, cache=T, warning = F, message = F, fig.path = &quot;figures/&quot;, dev = &quot;svglite&quot;, fig.width=5, fig.height=4)
options(digits=4, knitr.kable.NA = &quot;&quot;) # for kables

load(&quot;data/rims_data.rda&quot;)

sxc.labels &lt;- set_names(c(&quot;K intrapop&quot;, &quot;K interpop&quot;, &quot;K x H&quot;, &quot;H x K&quot;, &quot;H interpop&quot;, &quot;H intrapop&quot;), sxc.levels)
F1.col &lt;- set_names(c(brewer.pal(3,&quot;Greens&quot;)[2:3],brewer.pal(9,&quot;Oranges&quot;)[5], brewer.pal(9,&quot;Set1&quot;)[7], brewer.pal(3,&quot;Purples&quot;)[3:2]), sxc.levels)</code></pre>
<div id="datasets" class="section level1">
<h1>Datasets</h1>
<pre class="r"><code>traits %&gt;% filter(generation !=&quot;P&quot;) %&gt;% select(c(generation,ylab, yvar, data, type)) %&gt;% kable</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">generation</th>
<th align="left">ylab</th>
<th align="left">yvar</th>
<th align="left">data</th>
<th align="left">type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">F1</td>
<td align="left">Capsule formation</td>
<td align="left">capsule.formed</td>
<td align="left">seeds</td>
<td align="left">binary</td>
</tr>
<tr class="even">
<td align="left">F1</td>
<td align="left">Viable seeds if capsule formed</td>
<td align="left">viable.seeds</td>
<td align="left">seeds.nonzero</td>
<td align="left">continuous</td>
</tr>
<tr class="odd">
<td align="left">F1</td>
<td align="left">Germination</td>
<td align="left">prop.germ</td>
<td align="left">germination</td>
<td align="left">binary</td>
</tr>
<tr class="even">
<td align="left">F1</td>
<td align="left">Survival</td>
<td align="left">alive</td>
<td align="left">survflr</td>
<td align="left">binary</td>
</tr>
<tr class="odd">
<td align="left">F1</td>
<td align="left">Vegetative biomass (g)</td>
<td align="left">veg.biomass.g</td>
<td align="left">vegbiomass</td>
<td align="left">continuous</td>
</tr>
<tr class="even">
<td align="left">F1</td>
<td align="left">Flowering if survived</td>
<td align="left">flowered</td>
<td align="left">survflr.alive</td>
<td align="left">binary</td>
</tr>
<tr class="odd">
<td align="left">F1</td>
<td align="left">Days to flower</td>
<td align="left">firstflower</td>
<td align="left">survflr</td>
<td align="left">continuous</td>
</tr>
<tr class="even">
<td align="left">F1</td>
<td align="left">First inflorescence biomass (g)</td>
<td align="left">firstinflo.biomass.g</td>
<td align="left">survflr</td>
<td align="left">continuous</td>
</tr>
<tr class="odd">
<td align="left">F1</td>
<td align="left">Inflorescence biomass (g)</td>
<td align="left">inflo.biomass.g</td>
<td align="left">inflobiomass.sum</td>
<td align="left">continuous</td>
</tr>
<tr class="even">
<td align="left">F1</td>
<td align="left">Flower number</td>
<td align="left">flower.number</td>
<td align="left">inflobiomass.sum</td>
<td align="left">continuous</td>
</tr>
<tr class="odd">
<td align="left">F1</td>
<td align="left">Pollen viability</td>
<td align="left">prop.viable</td>
<td align="left">pollen</td>
<td align="left">binary</td>
</tr>
<tr class="even">
<td align="left">F1</td>
<td align="left">Pollen grains per anther</td>
<td align="left">total.per.anther</td>
<td align="left">pollen</td>
<td align="left">continuous</td>
</tr>
<tr class="odd">
<td align="left">F2</td>
<td align="left">Capsule formation</td>
<td align="left">capsule.formed</td>
<td align="left">f1seeds</td>
<td align="left">binary</td>
</tr>
<tr class="even">
<td align="left">F2</td>
<td align="left">Viable seeds if capsule formed</td>
<td align="left">viable.seeds</td>
<td align="left">f1seeds.nonzero</td>
<td align="left">continuous</td>
</tr>
<tr class="odd">
<td align="left">F2</td>
<td align="left">Seed mass (mg)</td>
<td align="left">seed.mass.mg</td>
<td align="left">f1seedmass</td>
<td align="left">continuous</td>
</tr>
<tr class="even">
<td align="left">F2</td>
<td align="left">Pollen viability</td>
<td align="left">prop.viable</td>
<td align="left">f2pollen</td>
<td align="left">binary</td>
</tr>
<tr class="odd">
<td align="left">F2</td>
<td align="left">Pollen grains per anther</td>
<td align="left">total.per.anther</td>
<td align="left">f2pollen</td>
<td align="left">continuous</td>
</tr>
<tr class="even">
<td align="left">F3</td>
<td align="left">Capsule formation</td>
<td align="left">capsule.formed</td>
<td align="left">f1seeds</td>
<td align="left">binary</td>
</tr>
<tr class="odd">
<td align="left">F3</td>
<td align="left">Viable seeds if capsule formed</td>
<td align="left">viable.seeds</td>
<td align="left">f1seeds.nonzero</td>
<td align="left">continuous</td>
</tr>
</tbody>
</table>
</div>
<div id="sample-sizes" class="section level1">
<h1>Sample sizes</h1>
<pre class="r"><code>F1 &lt;- set_names(datanames[1:6]); F1[[6]] &lt;- &quot;inflobiomass.sum&quot;
F2 &lt;- set_names(datanames[7:10])

map_dfr(F1, ~ tally(get(.)), .id=&quot;dataset&quot;) %&gt;% 
  pivot_wider(names_from=dataset, values_from=n) %&gt;% kable(caption=&quot;F1 datasets totals&quot;)</code></pre>
<table>
<caption>F1 datasets totals</caption>
<thead>
<tr class="header">
<th align="right">seeds</th>
<th align="right">germination</th>
<th align="right">vegbiomass</th>
<th align="right">survflr</th>
<th align="right">pollen</th>
<th align="right">inflobiomass</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">533</td>
<td align="right">236</td>
<td align="right">1067</td>
<td align="right">1567</td>
<td align="right">197</td>
<td align="right">1019</td>
</tr>
</tbody>
</table>
<pre class="r"><code>map_dfr(F1, ~ tally(group_by(get(.), crosstype, momsp, dadsp)), .id=&quot;dataset&quot;) %&gt;% 
  pivot_wider(names_from=dataset, values_from=n) %&gt;% kable(caption=&quot;F1 datasets by crosstype and species&quot;)</code></pre>
<table>
<caption>F1 datasets by crosstype and species</caption>
<thead>
<tr class="header">
<th align="left">crosstype</th>
<th align="left">momsp</th>
<th align="left">dadsp</th>
<th align="right">seeds</th>
<th align="right">germination</th>
<th align="right">vegbiomass</th>
<th align="right">survflr</th>
<th align="right">pollen</th>
<th align="right">inflobiomass</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">between</td>
<td align="left">hook</td>
<td align="left">hook</td>
<td align="right">64</td>
<td align="right">26</td>
<td align="right">257</td>
<td align="right">377</td>
<td align="right">15</td>
<td align="right">247</td>
</tr>
<tr class="even">
<td align="left">between</td>
<td align="left">kaal</td>
<td align="left">kaal</td>
<td align="right">55</td>
<td align="right">37</td>
<td align="right">193</td>
<td align="right">254</td>
<td align="right">37</td>
<td align="right">194</td>
</tr>
<tr class="odd">
<td align="left">within</td>
<td align="left">hook</td>
<td align="left">hook</td>
<td align="right">47</td>
<td align="right">19</td>
<td align="right">129</td>
<td align="right">223</td>
<td align="right">15</td>
<td align="right">118</td>
</tr>
<tr class="even">
<td align="left">within</td>
<td align="left">kaal</td>
<td align="left">kaal</td>
<td align="right">34</td>
<td align="right">19</td>
<td align="right">85</td>
<td align="right">125</td>
<td align="right">20</td>
<td align="right">89</td>
</tr>
<tr class="odd">
<td align="left">hybrid</td>
<td align="left">hook</td>
<td align="left">kaal</td>
<td align="right">156</td>
<td align="right">62</td>
<td align="right">332</td>
<td align="right">469</td>
<td align="right">61</td>
<td align="right">314</td>
</tr>
<tr class="even">
<td align="left">hybrid</td>
<td align="left">kaal</td>
<td align="left">hook</td>
<td align="right">177</td>
<td align="right">73</td>
<td align="right">71</td>
<td align="right">119</td>
<td align="right">49</td>
<td align="right">57</td>
</tr>
</tbody>
</table>
<pre class="r"><code>map_dfr(F1, ~ tally(group_by(get(.), crosstype, momsp, dadsp, mompop, dadpop)), .id=&quot;dataset&quot;) %&gt;% 
  pivot_wider(names_from=dataset, values_from=n) %&gt;% kable(caption=&quot;F1 datasets by crosstype and population&quot;)</code></pre>
<table>
<caption>F1 datasets by crosstype and population</caption>
<colgroup>
<col width="10%" />
<col width="6%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="6%" />
<col width="12%" />
<col width="11%" />
<col width="8%" />
<col width="7%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">crosstype</th>
<th align="left">momsp</th>
<th align="left">dadsp</th>
<th align="left">mompop</th>
<th align="left">dadpop</th>
<th align="right">seeds</th>
<th align="right">germination</th>
<th align="right">vegbiomass</th>
<th align="right">survflr</th>
<th align="right">pollen</th>
<th align="right">inflobiomass</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">between</td>
<td align="left">hook</td>
<td align="left">hook</td>
<td align="left">WK</td>
<td align="left">879WKG</td>
<td align="right">35</td>
<td align="right">14</td>
<td align="right">149</td>
<td align="right">241</td>
<td align="right">9</td>
<td align="right">145</td>
</tr>
<tr class="even">
<td align="left">between</td>
<td align="left">hook</td>
<td align="left">hook</td>
<td align="left">879WKG</td>
<td align="left">WK</td>
<td align="right">29</td>
<td align="right">12</td>
<td align="right">108</td>
<td align="right">136</td>
<td align="right">6</td>
<td align="right">102</td>
</tr>
<tr class="odd">
<td align="left">between</td>
<td align="left">kaal</td>
<td align="left">kaal</td>
<td align="left">892WKG</td>
<td align="left">904WPG</td>
<td align="right">11</td>
<td align="right">8</td>
<td align="right">31</td>
<td align="right">44</td>
<td align="right">7</td>
<td align="right">30</td>
</tr>
<tr class="even">
<td align="left">between</td>
<td align="left">kaal</td>
<td align="left">kaal</td>
<td align="left">892WKG</td>
<td align="left">3587WP</td>
<td align="right">5</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">12</td>
<td align="right">9</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">between</td>
<td align="left">kaal</td>
<td align="left">kaal</td>
<td align="left">904WPG</td>
<td align="left">892WKG</td>
<td align="right">10</td>
<td align="right">8</td>
<td align="right">83</td>
<td align="right">94</td>
<td align="right">6</td>
<td align="right">82</td>
</tr>
<tr class="even">
<td align="left">between</td>
<td align="left">kaal</td>
<td align="left">kaal</td>
<td align="left">904WPG</td>
<td align="left">3587WP</td>
<td align="right">7</td>
<td align="right">4</td>
<td align="right">23</td>
<td align="right">30</td>
<td align="right">5</td>
<td align="right">24</td>
</tr>
<tr class="odd">
<td align="left">between</td>
<td align="left">kaal</td>
<td align="left">kaal</td>
<td align="left">3587WP</td>
<td align="left">892WKG</td>
<td align="right">11</td>
<td align="right">7</td>
<td align="right">24</td>
<td align="right">31</td>
<td align="right">4</td>
<td align="right">26</td>
</tr>
<tr class="even">
<td align="left">between</td>
<td align="left">kaal</td>
<td align="left">kaal</td>
<td align="left">3587WP</td>
<td align="left">904WPG</td>
<td align="right">11</td>
<td align="right">7</td>
<td align="right">29</td>
<td align="right">43</td>
<td align="right">6</td>
<td align="right">29</td>
</tr>
<tr class="odd">
<td align="left">within</td>
<td align="left">hook</td>
<td align="left">hook</td>
<td align="left">WK</td>
<td align="left">WK</td>
<td align="right">25</td>
<td align="right">6</td>
<td align="right">72</td>
<td align="right">128</td>
<td align="right">10</td>
<td align="right">71</td>
</tr>
<tr class="even">
<td align="left">within</td>
<td align="left">hook</td>
<td align="left">hook</td>
<td align="left">879WKG</td>
<td align="left">879WKG</td>
<td align="right">22</td>
<td align="right">13</td>
<td align="right">57</td>
<td align="right">95</td>
<td align="right">5</td>
<td align="right">47</td>
</tr>
<tr class="odd">
<td align="left">within</td>
<td align="left">kaal</td>
<td align="left">kaal</td>
<td align="left">892WKG</td>
<td align="left">892WKG</td>
<td align="right">9</td>
<td align="right">6</td>
<td align="right">5</td>
<td align="right">15</td>
<td align="right">7</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">within</td>
<td align="left">kaal</td>
<td align="left">kaal</td>
<td align="left">904WPG</td>
<td align="left">904WPG</td>
<td align="right">14</td>
<td align="right">6</td>
<td align="right">63</td>
<td align="right">83</td>
<td align="right">6</td>
<td align="right">68</td>
</tr>
<tr class="odd">
<td align="left">within</td>
<td align="left">kaal</td>
<td align="left">kaal</td>
<td align="left">3587WP</td>
<td align="left">3587WP</td>
<td align="right">11</td>
<td align="right">7</td>
<td align="right">17</td>
<td align="right">27</td>
<td align="right">7</td>
<td align="right">16</td>
</tr>
<tr class="even">
<td align="left">hybrid</td>
<td align="left">hook</td>
<td align="left">kaal</td>
<td align="left">WK</td>
<td align="left">892WKG</td>
<td align="right">28</td>
<td align="right">11</td>
<td align="right">81</td>
<td align="right">118</td>
<td align="right">9</td>
<td align="right">75</td>
</tr>
<tr class="odd">
<td align="left">hybrid</td>
<td align="left">hook</td>
<td align="left">kaal</td>
<td align="left">WK</td>
<td align="left">904WPG</td>
<td align="right">20</td>
<td align="right">8</td>
<td align="right">34</td>
<td align="right">61</td>
<td align="right">10</td>
<td align="right">33</td>
</tr>
<tr class="even">
<td align="left">hybrid</td>
<td align="left">hook</td>
<td align="left">kaal</td>
<td align="left">WK</td>
<td align="left">3587WP</td>
<td align="right">26</td>
<td align="right">10</td>
<td align="right">27</td>
<td align="right">47</td>
<td align="right">7</td>
<td align="right">27</td>
</tr>
<tr class="odd">
<td align="left">hybrid</td>
<td align="left">hook</td>
<td align="left">kaal</td>
<td align="left">879WKG</td>
<td align="left">892WKG</td>
<td align="right">31</td>
<td align="right">11</td>
<td align="right">78</td>
<td align="right">100</td>
<td align="right">18</td>
<td align="right">74</td>
</tr>
<tr class="even">
<td align="left">hybrid</td>
<td align="left">hook</td>
<td align="left">kaal</td>
<td align="left">879WKG</td>
<td align="left">904WPG</td>
<td align="right">23</td>
<td align="right">10</td>
<td align="right">64</td>
<td align="right">84</td>
<td align="right">17</td>
<td align="right">65</td>
</tr>
<tr class="odd">
<td align="left">hybrid</td>
<td align="left">hook</td>
<td align="left">kaal</td>
<td align="left">879WKG</td>
<td align="left">3587WP</td>
<td align="right">28</td>
<td align="right">12</td>
<td align="right">48</td>
<td align="right">59</td>
<td align="right"></td>
<td align="right">40</td>
</tr>
<tr class="even">
<td align="left">hybrid</td>
<td align="left">kaal</td>
<td align="left">hook</td>
<td align="left">892WKG</td>
<td align="left">WK</td>
<td align="right">13</td>
<td align="right">7</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr class="odd">
<td align="left">hybrid</td>
<td align="left">kaal</td>
<td align="left">hook</td>
<td align="left">892WKG</td>
<td align="left">879WKG</td>
<td align="right">33</td>
<td align="right">15</td>
<td align="right">18</td>
<td align="right">24</td>
<td align="right">8</td>
<td align="right">16</td>
</tr>
<tr class="even">
<td align="left">hybrid</td>
<td align="left">kaal</td>
<td align="left">hook</td>
<td align="left">904WPG</td>
<td align="left">WK</td>
<td align="right">25</td>
<td align="right">10</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="right">1</td>
<td align="right"></td>
</tr>
<tr class="odd">
<td align="left">hybrid</td>
<td align="left">kaal</td>
<td align="left">hook</td>
<td align="left">904WPG</td>
<td align="left">879WKG</td>
<td align="right">36</td>
<td align="right">13</td>
<td align="right">34</td>
<td align="right">53</td>
<td align="right">25</td>
<td align="right">27</td>
</tr>
<tr class="even">
<td align="left">hybrid</td>
<td align="left">kaal</td>
<td align="left">hook</td>
<td align="left">3587WP</td>
<td align="left">WK</td>
<td align="right">32</td>
<td align="right">12</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="right">1</td>
<td align="right"></td>
</tr>
<tr class="odd">
<td align="left">hybrid</td>
<td align="left">kaal</td>
<td align="left">hook</td>
<td align="left">3587WP</td>
<td align="left">879WKG</td>
<td align="right">38</td>
<td align="right">16</td>
<td align="right">17</td>
<td align="right">28</td>
<td align="right">14</td>
<td align="right">14</td>
</tr>
</tbody>
</table>
<pre class="r"><code>map_dfr(F2, ~ tally(get(.)), .id=&quot;dataset&quot;) %&gt;% 
  pivot_wider(names_from=dataset, values_from=n) %&gt;% kable(caption=&quot;F2 datasets totals&quot;)</code></pre>
<table>
<caption>F2 datasets totals</caption>
<thead>
<tr class="header">
<th align="right">f1seeds</th>
<th align="right">f1seedmass</th>
<th align="right">f2pollen</th>
<th align="right">f2seeds</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1900</td>
<td align="right">230</td>
<td align="right">134</td>
<td align="right">222</td>
</tr>
</tbody>
</table>
<pre class="r"><code>map_dfr(F2, ~ tally(group_by(get(.), generation, momdadcross)), .id=&quot;dataset&quot;) %&gt;% 
  pivot_wider(names_from=dataset, values_from=n) %&gt;% kable(caption=&quot;F2 datasets by cross&quot;)</code></pre>
<table>
<caption>F2 datasets by cross</caption>
<thead>
<tr class="header">
<th align="left">generation</th>
<th align="left">momdadcross</th>
<th align="right">f1seeds</th>
<th align="right">f1seedmass</th>
<th align="right">f2pollen</th>
<th align="right">f2seeds</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Fcontrol</td>
<td align="left">HK x control</td>
<td align="right">38</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="left">Fcontrol</td>
<td align="left">KH x control</td>
<td align="right">74</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr class="odd">
<td align="left">FF</td>
<td align="left">HK x HK</td>
<td align="right">97</td>
<td align="right">15</td>
<td align="right">11</td>
<td align="right">38</td>
</tr>
<tr class="even">
<td align="left">FF</td>
<td align="left">KH x HK</td>
<td align="right">1</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr class="odd">
<td align="left">FF</td>
<td align="left">KH x KH</td>
<td align="right">195</td>
<td align="right">45</td>
<td align="right">16</td>
<td align="right">35</td>
</tr>
<tr class="even">
<td align="left">FP</td>
<td align="left">HK x H</td>
<td align="right">109</td>
<td align="right">18</td>
<td align="right">10</td>
<td align="right">28</td>
</tr>
<tr class="odd">
<td align="left">FP</td>
<td align="left">HK x K</td>
<td align="right">75</td>
<td align="right">7</td>
<td align="right">6</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="left">FP</td>
<td align="left">KH x H</td>
<td align="right">191</td>
<td align="right">28</td>
<td align="right">17</td>
<td align="right">25</td>
</tr>
<tr class="odd">
<td align="left">FP</td>
<td align="left">KH x K</td>
<td align="right">177</td>
<td align="right">29</td>
<td align="right">16</td>
<td align="right">22</td>
</tr>
<tr class="even">
<td align="left">Pcontrol</td>
<td align="left">H x control</td>
<td align="right">37</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr class="odd">
<td align="left">Pcontrol</td>
<td align="left">K x control</td>
<td align="right">101</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="left">PF</td>
<td align="left">H x HK</td>
<td align="right">57</td>
<td align="right">23</td>
<td align="right">17</td>
<td align="right">26</td>
</tr>
<tr class="odd">
<td align="left">PF</td>
<td align="left">H x KH</td>
<td align="right">91</td>
<td align="right">56</td>
<td align="right">22</td>
<td align="right">11</td>
</tr>
<tr class="even">
<td align="left">PF</td>
<td align="left">K x HK</td>
<td align="right">41</td>
<td align="right">3</td>
<td align="right">8</td>
<td align="right">12</td>
</tr>
<tr class="odd">
<td align="left">PF</td>
<td align="left">K x KH</td>
<td align="right">83</td>
<td align="right">6</td>
<td align="right">11</td>
<td align="right">18</td>
</tr>
<tr class="even">
<td align="left">PP</td>
<td align="left">H x H</td>
<td align="right">111</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr class="odd">
<td align="left">PP</td>
<td align="left">H x K</td>
<td align="right">156</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="left">PP</td>
<td align="left">K x H</td>
<td align="right">177</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr class="odd">
<td align="left">PP</td>
<td align="left">K x K</td>
<td align="right">89</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
</tr>
</tbody>
</table>
</div>
<div id="f1-generation" class="section level1">
<h1>F1 Generation</h1>
<div id="models" class="section level2">
<h2>Models</h2>
<pre class="r"><code>F1.mod &lt;- list(
  firstflower =          glmmTMB(firstflower ~          sxc +           (1|mompid) + (1|dadpid), data=survflr),
  firstinflo.biomass.g = glmmTMB(firstinflo.biomass.g ~ sxc + collect + (1|mompid) + (1|dadpid), data=survflr),
  inflo.biomass.g =      glmmTMB(inflo.biomass.g  ~     sxc + collect + (1|mompid) + (1|dadpid), data=inflobiomass.sum),
  flower.number =        glmmTMB(flower.number  ~       sxc + collect + (1|mompid) + (1|dadpop), data=inflobiomass.sum),#dadpid model prob.
  veg.biomass.g =        glmmTMB(veg.biomass.g ~        sxc + collect + (1|mompid) + (1|dadpid), data=vegbiomass),
  total.per.anther =     glmmTMB(total.per.anther ~     sxc +           (1|mompid) + (1|dadpid), data=pollen),
  viable.seeds =         glmmTMB(viable.seeds ~         sxc +           (1|mompid) + (1|dadpop), data=filter(seeds, viable.seeds&gt;0),
                                 family=&quot;truncated_nbinom1&quot;),
  prop.germ =            glmmTMB(prop.germ      ~ sxc + (1|mompid) + (1|dadpid), family=&quot;binomial&quot;, data=germination, weights = planted),
  alive =                glmmTMB(alive          ~ sxc + (1|mompid) + (1|dadpid), family=&quot;binomial&quot;, data=survflr),
  flowered =             glmmTMB(flowered       ~ sxc + (1|mompid) + (1|dadpid), family=&quot;binomial&quot;, data=filter(survflr, alive)),
  prop.viable =          glmmTMB(prop.viable    ~ sxc + (1|mompid) + (1|dadpid), family=&quot;binomial&quot;, data=pollen, weights = total),
  capsule.formed =       glmmTMB(capsule.formed ~ sxc + (1|mompid) + (1|dadpop), family=&quot;binomial&quot;, data=seeds))
#TODO try to find dadpid for seeds</code></pre>
</div>
<div id="inference" class="section level2">
<h2>Inference</h2>
<pre class="r"><code>F1.test &lt;- map_dfr(F1.mod, ~car::Anova(.) %&gt;% tidy(), .id=&quot;trait&quot;)
F1.emm &lt;-  map_dfr(F1.mod, ~emmeans(., ~sxc) %&gt;% summary(type=&quot;response&quot;) %&gt;%  #average over collect date
                             tidy %&gt;% rename(estimate=any_of(c(&quot;response&quot;,&quot;prob&quot;))), .id=&quot;trait&quot;) </code></pre>
</div>
<div id="plots" class="section level2">
<h2>Plots</h2>
<pre class="r"><code>plot_F1 &lt;- function(emm, data, yvar, ylab, type=&quot;continuous&quot;) {
  data &lt;- get(data)
  if(type==&quot;continuous&quot;) {
    p &lt;- ggplot(data, aes_string(y=yvar, x=&quot;sxc&quot;, fill=&quot;sxc&quot;)) +
      geom_violin(draw_quantiles = (1:3)/4) + 
      geom_pointrange(data=filter(emm, trait==yvar), aes(y=estimate, ymax=conf.high, ymin=conf.low)) + 
      scale_fill_manual(values=F1.col) + guides(fill=&quot;none&quot;) +
      scale_y_continuous(name = ylab, expand = expansion(mult=c(0, 0.05)), limits=c(0,NA))
  } else if(type==&quot;binary&quot;) {
    p &lt;- data %&gt;% drop_na(all_of(yvar)) %&gt;% 
      group_by(sxc, mompop, dadpop) %&gt;% summarize(across(all_of(yvar), ~sum(.)/n()), n=n(), .groups=&quot;drop&quot;) %&gt;% 
      ggplot(aes_string(y=yvar, x=&quot;sxc&quot;, color=&quot;sxc&quot;)) +
      geom_point(size=4)+
      geom_pointrange(data=filter(emm, trait==yvar) %&gt;% 
                        mutate(conf.low  = ifelse(conf.high-conf.low&gt;0.9,NA,conf.low), 
                               conf.high = ifelse(conf.high-conf.low&gt;0.9,NA,conf.high)), 
                      aes(y=estimate, ymax=conf.high, ymin=conf.low), color=&quot;black&quot;) + 
      scale_color_manual(values=F1.col) + guides(color=&quot;none&quot;) +
      scale_y_continuous(ylab, limits=c(0,1), labels=~scales::percent(.,accuracy=1))
  }
  p &lt;- p + scale_x_discrete(&quot;Cross&quot;, labels = sxc.labels) + 
    theme_minimal() + theme(panel.grid.major.x = element_blank())
  print(p)
}

traits %&gt;% filter(generation==&quot;F1&quot;) %&gt;% select(data, yvar, ylab, type) %&gt;% 
  pwalk(plot_F1, emm=F1.emm)</code></pre>
<p><img src="figures/f1plot-1.svg" width="480" /><img src="figures/f1plot-2.svg" width="480" /><img src="figures/f1plot-3.svg" width="480" /><img src="figures/f1plot-4.svg" width="480" /><img src="figures/f1plot-5.svg" width="480" /><img src="figures/f1plot-6.svg" width="480" /><img src="figures/f1plot-7.svg" width="480" /><img src="figures/f1plot-8.svg" width="480" /><img src="figures/f1plot-9.svg" width="480" /><img src="figures/f1plot-10.svg" width="480" /><img src="figures/f1plot-11.svg" width="480" /><img src="figures/f1plot-12.svg" width="480" /></p>
</div>
<div id="flower-biomass-regression" class="section level2">
<h2>Flower biomass regression</h2>
<pre class="r"><code>ggplot(inflobiomass, aes(x=inflo.biomass.g, y=flrs, color=cross)) + 
  geom_point() +  geom_smooth(method=&quot;lm&quot;, se=F) +  
  geom_rug(data=inflobiomass.sum, aes(x=inflo.biomass.g/inflo, y=10), sides=&quot;b&quot;) + 
  scale_x_log10() + scale_y_log10() + 
  scale_color_manual(values=set_names(F1.col, c(&quot;KKwithin&quot;,&quot;KK&quot;, &quot;KH&quot;, &quot;HK&quot;, &quot;HH&quot;, &quot;HHwithin&quot;))[-c(1,6)]) +
  theme_minimal() + labs(y=&quot;Flower number&quot;, x=&quot;Inflorescence biomass (g)&quot;, color=&quot;Cross&quot;)</code></pre>
<p><img src="figures/infloreg-1.svg" width="480" /></p>
<pre class="r"><code>ggplot(inflobiomass, aes(x=inflo.biomass.g, y=flrs/inflo.biomass.g, color=cross)) + 
  geom_point() +  geom_smooth(se=F) +  
  scale_x_log10() + scale_y_continuous() + 
  scale_color_manual(values=set_names(F1.col, c(&quot;KKwithin&quot;,&quot;KK&quot;, &quot;KH&quot;, &quot;HK&quot;, &quot;HH&quot;, &quot;HHwithin&quot;))[-c(1,6)]) +
  theme_minimal() + labs(y=&quot;Flowers per g biomass&quot;, x=&quot;Inflorescence biomass (g)&quot;, color=&quot;Cross&quot;)</code></pre>
<p><img src="figures/infloreg-2.svg" width="480" /></p>
<pre class="r"><code>ggplot(inflobiomass.sum, aes(y=inflo, x=sxc, fill=sxc)) +
  geom_boxplot() + 
  scale_fill_manual(values=F1.col) + guides(fill=&quot;none&quot;) +
  scale_y_continuous(&quot;Inflorescences&quot;, expand = expansion(mult=c(0, 0.05)), limits=c(0,NA))+
  scale_x_discrete(&quot;Cross&quot;, labels = sxc.labels) + 
  theme_minimal() + theme(panel.grid.major.x = element_blank())</code></pre>
<p><img src="figures/infloreg-3.svg" width="480" /></p>
<pre class="r"><code>ggplot(inflobiomass.sum, aes(y=inflo.biomass.g/inflo, x=sxc, fill=sxc)) +
  geom_boxplot() + 
  scale_fill_manual(values=F1.col) + guides(fill=&quot;none&quot;) +
  scale_y_continuous(&quot;Biomass per inflorescence (g)&quot;, expand = expansion(mult=c(0, 0.05)), limits=c(0,NA))+
  scale_x_discrete(&quot;Cross&quot;, labels = sxc.labels) + 
  theme_minimal() + theme(panel.grid.major.x = element_blank())</code></pre>
<p><img src="figures/infloreg-4.svg" width="480" /></p>
<pre class="r"><code>ggplot(inflobiomass.sum, aes(y=flower.number/inflo, x=sxc, fill=sxc)) +
  geom_boxplot() + 
  scale_fill_manual(values=F1.col) + guides(fill=&quot;none&quot;) +
  scale_y_continuous(&quot;Flowers per inflorescence&quot;, expand = expansion(mult=c(0, 0.05)), limits=c(0,NA))+
  scale_x_discrete(&quot;Cross&quot;, labels = sxc.labels) + 
  theme_minimal() + theme(panel.grid.major.x = element_blank())</code></pre>
<p><img src="figures/infloreg-5.svg" width="480" /></p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
